<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  th:replace="fragments/layout :: layout(~{:: main}, ~{:: script}, ~{:: link})"
>
  <head>
    <link rel="stylesheet" th:href="@{/css/video/detail.css}" />
  </head>
  <body>
    <div class="main" th:fragment="main">
      <div id="detailWrapper">
        <div id="detailHead">
          <span id="detailTitle" th:text="${article.title}">[생활코딩] HTML5 기초강좌</span>
          <div id="detailViewCount">
            <span th:text="${article.writer.name}">매니저</span> | 
            <span th:text="${#temporals.format(article.timeLocal, 'yyyy-MM-dd')}"></span>
            | 
            조회수 <span id="point" th:text="${article.view_count}">43</span> | 
            댓글 <span id="point" th:text="${article.commentlist.size()}">2</span>
          </div>
        </div>
        <div id="detailContent">
          <div id="videoWrapper">
            <iframe
              src="https://youtube.com/embed/tZooW6PritE"
              th:src="'https://youtube.com/embed/' + ${article.option.video_id}"
              id="video"
            ></iframe>
          </div>
          <div id="detailContentText" th:utext="${article.content}"></div>
          <div id="voteButtonWrapper">
          	<button class="btn btn-primary btn-sm" id="voteButton">추천 <span id="voteText" th:utext = "${article.vote_count}">0</span></button>
          </div>
        </div>
      </div>
      <div id="buttonWrapper">
        <a class="btn btn-primary btn-sm" th:href="@{/video/edit}">수정</a>
        <a class="btn btn-primary btn-sm" th:href="@{/video/delete}">삭제</a>
        <a class="btn btn-primary btn-sm" th:href="@{/video/home}">목록</a>
      </div>
      <div id="commentsWrapper">
        <div id="commentsContent">
          <div id="commentsText">
            <div id="commentsWriter">
              <span id="writerIcon">
                <img src="https://via.placeholder.com/32" id="icon" />
              </span>
              <span id="writerName">권순조</span>
              <span id="writeDate">2019.6.22 17:59</span>
            </div>
            <div id="commentsDetail">사퇴하겠습니다</div>
          </div>
        </div>
        <div id="commentsContent">
          <div id="commentsText">
            <div id="commentsWriter">
              <span id="writerIcon">
                <img src="https://via.placeholder.com/32" id="icon" />
              </span>
              <span id="writerName">이힘찬</span>
              <span id="writeDate">2019.6.22 17:55</span>
            </div>
            <div id="commentsDetail">이고잉님 사랑해용 쀼쀼</div>
          </div>
        </div>
      </div>
    </div>

    <script>
      $('#voteButton').click(function(data){
        var para = document.location.href.split("?"); 
        var param = para[1].split("=");
        $.ajax({
          url:"/ajax/vote",
          data:{
            articleId:param[1],           
          },
          method:"post",
          success:function(data){
			      $("#voteText").html(data);
          }
        })
      });
    </script>
  </body>
</html>
