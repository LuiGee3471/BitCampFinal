<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
  th:replace="fragments/layout :: layout(~{:: main}, ~{:: script}, ~{:: link})">
<head>
<!-- 이 페이지에서만 별도로 사용하는 CSS가 있다면 여기다 link 태그로 삽입 -->
<link rel="stylesheet" th:href="@{/css/myclass/homework/detail.css}" />
<link
  href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.css"
  rel="stylesheet" />

</head>
<body>
  <!-- 이 페이지의 내용은 main 클래스 div 태그 안에 작성 -->
  <div class="main" th:fragment="main">
    <div class="row">
      <div id="title">과제 제출</div>
    </div>
    <div class="row" th:object="${article}">
      <div class="homework-container">
        <span class="hw-title">제목</span> <span class="homework-title"
          th:text="${article.title}">안녕</span> <span class="hw-title">작성자</span>
        <span class="homework-name" th:text="${article.writer.name}">임경균강사님</span>
      </div>
      <div class="homework-container">
        <span class="hw-title">시작일</span> <span
          class="homework-startDate"
          th:text="${#strings.arraySplit(article.time,' ')[0]}">2019-07-01</span>
        <span class="hw-title">종료일</span> <span class="homework-endDate"
          th:text="${article.option.end_date}">2019-07-29</span>
      </div>
      <div class="homework-content" th:utext="${article.content}">별찍기
        10문제를 만들어서 올리세요^^</div>
      <div class="button-wrapper" id="buttons">
        <a href="/myclass/homework" class="btn btn-primary btn-sm">목록</a>
        <a th:href="@{/myclass/homework/edit(id=${article.id})}"
          class="btn btn-primary btn-sm">수정</a>
        <button class="btn btn-primary btn-sm" id="delete-btn">삭제</button>
      </div>
    </div>
    <form method="post" enctype="multipart/form-data">
      <input type="hidden" name="original_id" th:value="${article.id}">
      <div class="homework-container">
        <span class="ppt-upload-text">발표자료</span><span
          class="ppt-upload-input"><input type="file"
          name="file1"></span> <span class="source-upload-text">소스코드</span><span
          class="source-upload-input"><input type="file"
          name="file2"></span>
      </div>
      <div class="homework-submit">
        <textarea name="content" id="summernote"></textarea>
      </div>
      <!-- <input type="text" class="homework-submit" placeholder="  내용을 입력하세요"> -->
      <div id="buttons">
        <input type="submit" class="btn btn-primary btn-sm" value="제출">
      </div>
    </form>
    <div class="row" th:each="reply : ${replies}">
      <div class="reply-container">
        <div class="submit-container">
          <span class="sm-title">이름</span> <span class="submit-name"
            th:text="${reply.writer.name}">이힘찬</span> <span
            class="sm-title">제출일</span> <span class="submit-writeDate"
            th:text="${#temporals.format(reply.timeLocal, 'yyyy-MM-dd')}">2019-07-28</span>
        </div>
        <div class="submit-container">
          <span class="sm-title">조</span> <span class="submit-group">2조</span>
          <span class="sm-title">첨부파일</span> <span class="submit-file"
            th:if="${reply.option.files[0] == null}">등록된 파일이
            없습니다.</span> <a th:if="${reply.option.files[0] != null}"
            th:href="@{{filename}(filename=${reply.option.files[0].filename})}"
            th:attr="download=${reply.option.files[0].original_filename}">
            <span class="submit-file"
            th:text="${reply.option.files[0].original_filename}">javaHomework.jar</span>
          </a> <a th:if="${reply.option.files[1] != null}"
            th:href="@{{filename}(filename=${reply.option.files[1].filename})}"
            th:attr="download=${reply.option.files[1].original_filename}">
            <span class="submit-file"
            th:if="${reply.option.files[1] != null}"
            th:text="${reply.option.files[1].original_filename}">javaHomework.jar</span>
          </a>
        </div>
        <div class="homework-content" th:utext="${reply.content}">감사합니다^^</div>
      </div>
      <div id="update-buttons">
        <input type="button" class="btn btn-primary btn-sm" value="수정">
        <input type="button" class="btn btn-primary btn-sm" value="삭제">
      </div>
    </div>
  </div>

  <!-- 필요하다면 이 아래에 외부 자바스크립트도 추가 가능 -->
  <script
    src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
  <!-- 이 페이지에서 사용하는 자바스크립트는 이 script 태그 안에 작성 -->
  <script>
      $("#summernote").summernote({
        height : 300,
        disableResizeEditor : true
      });
      
      $("#delete-btn").click(function(event) {
        
        Swal.fire({
          title: '정말 삭제하시겠습니까?',
          type: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#F39B10',
          cancelButtonColor: '#A6A6A6',
          confirmButtonText: '네',
          cancelButtonText: '아니요'
        }).then((result) => {
          if (result.value) {
           
            $.ajax({
              url: "/myclass/homework/delete",
              type: "POST",
              data: {
                id: [[${article.id}]]
              },
              success: function(data) {
                Swal.fire({
                  	title: '삭제되었습니다',
                  	type: 'success',
                  	confirmButtonText: '확인',
                  	confirmButtonColor: '#F39B10'
                    
                }).then(function() {
                    location.href = "/myclass/homework";
                  });
                
              }
            });
            
          }
        })
  
      });
    </script>
</body>
</html>